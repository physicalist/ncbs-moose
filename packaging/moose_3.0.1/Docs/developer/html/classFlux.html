<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>MOOSE: Flux Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MOOSE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classFlux-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Flux Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="RateTerm_8h_source.html">RateTerm.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Flux:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classFlux.png" usemap="#Flux_map" alt=""/>
  <map id="Flux_map" name="Flux_map">
<area href="classZeroOrder.html" alt="ZeroOrder" shape="rect" coords="0,56,74,80"/>
<area href="classRateTerm.html" alt="RateTerm" shape="rect" coords="0,0,74,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8e31270478a38c4e07d1762e29df4958"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFlux.html#a8e31270478a38c4e07d1762e29df4958">Flux</a> (double k, unsigned int <a class="el" href="Normal_8cpp.html#a18dc84a68cf977f9c6b17957d747a6b3">y</a>)</td></tr>
<tr class="separator:a8e31270478a38c4e07d1762e29df4958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33e43ea4401372cf5c55a4f81a11aae0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFlux.html#a33e43ea4401372cf5c55a4f81a11aae0">operator()</a> (const double *S) const </td></tr>
<tr class="memdesc:a33e43ea4401372cf5c55a4f81a11aae0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the rate. The argument is the molecule array.  <a href="#a33e43ea4401372cf5c55a4f81a11aae0">More...</a><br/></td></tr>
<tr class="separator:a33e43ea4401372cf5c55a4f81a11aae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34751b16c4351de5c4a3cc1a73a7a4ad"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFlux.html#a34751b16c4351de5c4a3cc1a73a7a4ad">getReactants</a> (vector&lt; unsigned int &gt; &amp;molIndex) const </td></tr>
<tr class="separator:a34751b16c4351de5c4a3cc1a73a7a4ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd9f5427706e96e4c3081e25304b48d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFlux.html#a8bd9f5427706e96e4c3081e25304b48d">rescaleVolume</a> (short comptIndex, const vector&lt; short &gt; &amp;compartmentLookup, double ratio)</td></tr>
<tr class="separator:a8bd9f5427706e96e4c3081e25304b48d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a7275b4197b3b5a7c18fbc2b09ffb0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRateTerm.html">RateTerm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFlux.html#a56a7275b4197b3b5a7c18fbc2b09ffb0">copyWithVolScaling</a> (double vol, double sub, double prd) const </td></tr>
<tr class="separator:a56a7275b4197b3b5a7c18fbc2b09ffb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classZeroOrder"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classZeroOrder')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classZeroOrder.html">ZeroOrder</a></td></tr>
<tr class="memitem:ad578154a7360bc42bd883465270b8dbf inherit pub_methods_classZeroOrder"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#ad578154a7360bc42bd883465270b8dbf">ZeroOrder</a> (double k)</td></tr>
<tr class="separator:ad578154a7360bc42bd883465270b8dbf inherit pub_methods_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a128619ce58b35a0f4507ec69a3eb30f4 inherit pub_methods_classZeroOrder"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#a128619ce58b35a0f4507ec69a3eb30f4">setK</a> (double k)</td></tr>
<tr class="separator:a128619ce58b35a0f4507ec69a3eb30f4 inherit pub_methods_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20df8df444598cdd6f23584b278b5f1 inherit pub_methods_classZeroOrder"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#af20df8df444598cdd6f23584b278b5f1">setRates</a> (double k1, double k2)</td></tr>
<tr class="separator:af20df8df444598cdd6f23584b278b5f1 inherit pub_methods_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4982b8242f448f63a1377f2b867998 inherit pub_methods_classZeroOrder"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#a4c4982b8242f448f63a1377f2b867998">setR1</a> (double k1)</td></tr>
<tr class="memdesc:a4c4982b8242f448f63a1377f2b867998 inherit pub_methods_classZeroOrder"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by Zombie to assign rate terms.  <a href="#a4c4982b8242f448f63a1377f2b867998">More...</a><br/></td></tr>
<tr class="separator:a4c4982b8242f448f63a1377f2b867998 inherit pub_methods_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c84e13c671f27cea28f56957b9eceab inherit pub_methods_classZeroOrder"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#a2c84e13c671f27cea28f56957b9eceab">setR2</a> (double k2)</td></tr>
<tr class="memdesc:a2c84e13c671f27cea28f56957b9eceab inherit pub_methods_classZeroOrder"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by Zombie to assign rate terms.  <a href="#a2c84e13c671f27cea28f56957b9eceab">More...</a><br/></td></tr>
<tr class="separator:a2c84e13c671f27cea28f56957b9eceab inherit pub_methods_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa151633dca0574952fbece3be9244627 inherit pub_methods_classZeroOrder"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#aa151633dca0574952fbece3be9244627">getR1</a> () const </td></tr>
<tr class="memdesc:aa151633dca0574952fbece3be9244627 inherit pub_methods_classZeroOrder"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by Zombie to return rate terms.  <a href="#aa151633dca0574952fbece3be9244627">More...</a><br/></td></tr>
<tr class="separator:aa151633dca0574952fbece3be9244627 inherit pub_methods_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9beffb094056087b2e4108a83738f9 inherit pub_methods_classZeroOrder"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#aec9beffb094056087b2e4108a83738f9">getR2</a> () const </td></tr>
<tr class="memdesc:aec9beffb094056087b2e4108a83738f9 inherit pub_methods_classZeroOrder"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by Zombie to return rate terms.  <a href="#aec9beffb094056087b2e4108a83738f9">More...</a><br/></td></tr>
<tr class="separator:aec9beffb094056087b2e4108a83738f9 inherit pub_methods_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classRateTerm"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classRateTerm')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classRateTerm.html">RateTerm</a></td></tr>
<tr class="memitem:a3fe9a3f2a9c5701276de7aaf89e4bd06 inherit pub_methods_classRateTerm"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRateTerm.html#a3fe9a3f2a9c5701276de7aaf89e4bd06">RateTerm</a> ()</td></tr>
<tr class="separator:a3fe9a3f2a9c5701276de7aaf89e4bd06 inherit pub_methods_classRateTerm"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a097b1971a7652a8771245f17f28356a1 inherit pub_methods_classRateTerm"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRateTerm.html#a097b1971a7652a8771245f17f28356a1">~RateTerm</a> ()</td></tr>
<tr class="separator:a097b1971a7652a8771245f17f28356a1 inherit pub_methods_classRateTerm"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_attribs_classRateTerm"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classRateTerm')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classRateTerm.html">RateTerm</a></td></tr>
<tr class="memitem:a211734fd07c0ef1949907d832d9d03fd inherit pub_static_attribs_classRateTerm"><td class="memItemLeft" align="right" valign="top">static const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRateTerm.html#a211734fd07c0ef1949907d832d9d03fd">EPSILON</a> = 1.0e-6</td></tr>
<tr class="separator:a211734fd07c0ef1949907d832d9d03fd inherit pub_static_attribs_classRateTerm"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classZeroOrder"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classZeroOrder')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classZeroOrder.html">ZeroOrder</a></td></tr>
<tr class="memitem:a203d659a97645b4e5c4020ea0a331c8b inherit pro_attribs_classZeroOrder"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZeroOrder.html#a203d659a97645b4e5c4020ea0a331c8b">k_</a></td></tr>
<tr class="separator:a203d659a97645b4e5c4020ea0a331c8b inherit pro_attribs_classZeroOrder"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This rather odd reaction is used when we have an amount y of a molecule and we want it to proceed to zero at a fixed rate k. k would usually be 1/dt. Following dt seconds, we need to update y as it has nominally all been used up. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8e31270478a38c4e07d1762e29df4958"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Flux::Flux </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="classFlux.html#a56a7275b4197b3b5a7c18fbc2b09ffb0">copyWithVolScaling()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a56a7275b4197b3b5a7c18fbc2b09ffb0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRateTerm.html">RateTerm</a>* Flux::copyWithVolScaling </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Duplicates rate term and then applies volume scaling. Arguments are volume of reference voxel, product of vol/refVol for all substrates: applied to R1 product of vol/refVol for all products: applied to R2</p>
<p>Note that unless the reaction is cross-compartment, the vol/refVol will be one. </p>

<p>Reimplemented from <a class="el" href="classZeroOrder.html#ab5d53357e0e0cd4daeb70ad93482c28e">ZeroOrder</a>.</p>

<p>References <a class="el" href="classFlux.html#a8e31270478a38c4e07d1762e29df4958">Flux()</a>, and <a class="el" href="classZeroOrder.html#a203d659a97645b4e5c4020ea0a331c8b">ZeroOrder::k_</a>.</p>

</div>
</div>
<a class="anchor" id="a34751b16c4351de5c4a3cc1a73a7a4ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int Flux::getReactants </td>
          <td>(</td>
          <td class="paramtype">vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>molIndex</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function finds the reactant indices in the vector S. It returns the number of substrates found, which are the first entries in molIndex. The products are the remaining ones. Note that it does NOT find products for unidirectional reactions, which is a bit of a problem. </p>

<p>Reimplemented from <a class="el" href="classZeroOrder.html#a1616020e1ac380aad7c1cfa78a3af23a">ZeroOrder</a>.</p>

</div>
</div>
<a class="anchor" id="a33e43ea4401372cf5c55a4f81a11aae0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Flux::operator() </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>S</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the rate. The argument is the molecule array. </p>

<p>Reimplemented from <a class="el" href="classZeroOrder.html#a4a181b0e0f5ada2e01f6eb2494e65ca6">ZeroOrder</a>.</p>

<p>References <a class="el" href="classZeroOrder.html#a203d659a97645b4e5c4020ea0a331c8b">ZeroOrder::k_</a>.</p>

</div>
</div>
<a class="anchor" id="a8bd9f5427706e96e4c3081e25304b48d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Flux::rescaleVolume </td>
          <td>(</td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>comptIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; short &gt; &amp;&#160;</td>
          <td class="paramname"><em>compartmentLookup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is used to rescale the <a class="el" href="classRateTerm.html">RateTerm</a> kinetics when the compartment volume changes. This is needed because the kinetics are in extensive units, that is, mol numbers, rather than in intensive units like concentration. So when the volume changes the rate terms change. Each Rate term checks if any of its reactant molecules are affected, and if so, rescales. Ratio is newVol / oldVol </p>

<p>Reimplemented from <a class="el" href="classZeroOrder.html#ab31d8b34ef0bd4b26930aef697a3c117">ZeroOrder</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>ksolve/<a class="el" href="RateTerm_8h_source.html">RateTerm.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 2 2015 21:51:26 for MOOSE by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
